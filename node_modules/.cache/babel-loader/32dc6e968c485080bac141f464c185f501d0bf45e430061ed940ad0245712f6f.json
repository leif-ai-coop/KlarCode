{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback, useEffect } from 'react';\nimport { searchICDCodes, searchOPSCodes, getCurrentYear, loadICDData, loadOPSData } from '../services/dataService';\n\n/**\r\n * Custom hook for medical code searching\r\n */\nconst useCodeSearch = () => {\n  _s();\n  const [searchInput, setSearchInput] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [errors, setErrors] = useState([]);\n  const [duplicatesRemoved, setDuplicatesRemoved] = useState(0);\n  const [selectedYear, setSelectedYear] = useState(getCurrentYear());\n  const [showMore, setShowMore] = useState({\n    kapitel: false,\n    gruppe: false,\n    dreisteller: false\n  });\n\n  // Initialize data loading\n  useEffect(() => {\n    const initializeData = async () => {\n      try {\n        setIsLoading(true);\n        // Preload data for the current year\n        await Promise.all([loadICDData(selectedYear), loadOPSData(selectedYear)]);\n      } catch (error) {\n        console.error('Error initializing data:', error);\n        setErrors(prev => [...prev, `Fehler beim Laden der Daten: ${error.message}`]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    initializeData();\n  }, [selectedYear]);\n\n  /**\r\n   * Handle search input change\r\n   * @param {string} value - New search input value\r\n   */\n  const handleInputChange = useCallback(value => {\n    setSearchInput(value);\n  }, []);\n\n  /**\r\n   * Perform the search with the current input\r\n   */\n  const handleSearch = useCallback(async () => {\n    if (!searchInput.trim()) {\n      return;\n    }\n    setIsLoading(true);\n    setErrors([]);\n    setSearchResults([]);\n    setDuplicatesRemoved(0);\n    try {\n      // Search for both ICD and OPS codes\n      const [icdResults, opsResults] = await Promise.all([searchICDCodes(searchInput, selectedYear), searchOPSCodes(searchInput, selectedYear)]);\n\n      // Combine results and errors\n      const combinedResults = [...icdResults.results, ...opsResults.results];\n      const combinedErrors = [...icdResults.errors, ...opsResults.errors];\n      const totalDuplicatesRemoved = icdResults.duplicatesRemoved + opsResults.duplicatesRemoved;\n      setSearchResults(combinedResults);\n      setErrors(combinedErrors);\n      setDuplicatesRemoved(totalDuplicatesRemoved);\n    } catch (error) {\n      console.error('Error during search:', error);\n      setErrors([`Fehler bei der Suche: ${error.message}`]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [searchInput, selectedYear]);\n\n  /**\r\n   * Handle year change\r\n   * @param {string} year - New year value\r\n   */\n  const handleYearChange = useCallback(year => {\n    setSelectedYear(year);\n  }, []);\n\n  /**\r\n   * Toggle showing additional info columns\r\n   * @param {string} field - Field to toggle (kapitel, gruppe, dreisteller)\r\n   */\n  const toggleShowMore = useCallback(field => {\n    setShowMore(prev => ({\n      ...prev,\n      [field]: !prev[field]\n    }));\n  }, []);\n\n  /**\r\n   * Clear all search results and inputs\r\n   */\n  const handleClear = useCallback(() => {\n    setSearchInput('');\n    setSearchResults([]);\n    setErrors([]);\n    setDuplicatesRemoved(0);\n  }, []);\n  return {\n    searchInput,\n    searchResults,\n    isLoading,\n    errors,\n    duplicatesRemoved,\n    selectedYear,\n    showMore,\n    handleInputChange,\n    handleSearch,\n    handleYearChange,\n    toggleShowMore,\n    handleClear\n  };\n};\n_s(useCodeSearch, \"/oGgmnaCh6POJkmxv6C8MZtRAHk=\");\nexport default useCodeSearch;","map":{"version":3,"names":["useState","useCallback","useEffect","searchICDCodes","searchOPSCodes","getCurrentYear","loadICDData","loadOPSData","useCodeSearch","_s","searchInput","setSearchInput","searchResults","setSearchResults","isLoading","setIsLoading","errors","setErrors","duplicatesRemoved","setDuplicatesRemoved","selectedYear","setSelectedYear","showMore","setShowMore","kapitel","gruppe","dreisteller","initializeData","Promise","all","error","console","prev","message","handleInputChange","value","handleSearch","trim","icdResults","opsResults","combinedResults","results","combinedErrors","totalDuplicatesRemoved","handleYearChange","year","toggleShowMore","field","handleClear"],"sources":["C:/Code/KlarCode/src/hooks/useCodeSearch.js"],"sourcesContent":["import { useState, useCallback, useEffect } from 'react';\r\nimport { searchICDCodes, searchOPSCodes, getCurrentYear, loadICDData, loadOPSData } from '../services/dataService';\r\n\r\n/**\r\n * Custom hook for medical code searching\r\n */\r\nconst useCodeSearch = () => {\r\n  const [searchInput, setSearchInput] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [errors, setErrors] = useState([]);\r\n  const [duplicatesRemoved, setDuplicatesRemoved] = useState(0);\r\n  const [selectedYear, setSelectedYear] = useState(getCurrentYear());\r\n  const [showMore, setShowMore] = useState({\r\n    kapitel: false,\r\n    gruppe: false,\r\n    dreisteller: false\r\n  });\r\n  \r\n  // Initialize data loading\r\n  useEffect(() => {\r\n    const initializeData = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        // Preload data for the current year\r\n        await Promise.all([\r\n          loadICDData(selectedYear),\r\n          loadOPSData(selectedYear)\r\n        ]);\r\n      } catch (error) {\r\n        console.error('Error initializing data:', error);\r\n        setErrors(prev => [...prev, `Fehler beim Laden der Daten: ${error.message}`]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n    \r\n    initializeData();\r\n  }, [selectedYear]);\r\n  \r\n  /**\r\n   * Handle search input change\r\n   * @param {string} value - New search input value\r\n   */\r\n  const handleInputChange = useCallback((value) => {\r\n    setSearchInput(value);\r\n  }, []);\r\n  \r\n  /**\r\n   * Perform the search with the current input\r\n   */\r\n  const handleSearch = useCallback(async () => {\r\n    if (!searchInput.trim()) {\r\n      return;\r\n    }\r\n    \r\n    setIsLoading(true);\r\n    setErrors([]);\r\n    setSearchResults([]);\r\n    setDuplicatesRemoved(0);\r\n    \r\n    try {\r\n      // Search for both ICD and OPS codes\r\n      const [icdResults, opsResults] = await Promise.all([\r\n        searchICDCodes(searchInput, selectedYear),\r\n        searchOPSCodes(searchInput, selectedYear)\r\n      ]);\r\n      \r\n      // Combine results and errors\r\n      const combinedResults = [...icdResults.results, ...opsResults.results];\r\n      const combinedErrors = [...icdResults.errors, ...opsResults.errors];\r\n      const totalDuplicatesRemoved = icdResults.duplicatesRemoved + opsResults.duplicatesRemoved;\r\n      \r\n      setSearchResults(combinedResults);\r\n      setErrors(combinedErrors);\r\n      setDuplicatesRemoved(totalDuplicatesRemoved);\r\n    } catch (error) {\r\n      console.error('Error during search:', error);\r\n      setErrors([`Fehler bei der Suche: ${error.message}`]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [searchInput, selectedYear]);\r\n  \r\n  /**\r\n   * Handle year change\r\n   * @param {string} year - New year value\r\n   */\r\n  const handleYearChange = useCallback((year) => {\r\n    setSelectedYear(year);\r\n  }, []);\r\n  \r\n  /**\r\n   * Toggle showing additional info columns\r\n   * @param {string} field - Field to toggle (kapitel, gruppe, dreisteller)\r\n   */\r\n  const toggleShowMore = useCallback((field) => {\r\n    setShowMore(prev => ({\r\n      ...prev,\r\n      [field]: !prev[field]\r\n    }));\r\n  }, []);\r\n  \r\n  /**\r\n   * Clear all search results and inputs\r\n   */\r\n  const handleClear = useCallback(() => {\r\n    setSearchInput('');\r\n    setSearchResults([]);\r\n    setErrors([]);\r\n    setDuplicatesRemoved(0);\r\n  }, []);\r\n  \r\n  return {\r\n    searchInput,\r\n    searchResults,\r\n    isLoading,\r\n    errors,\r\n    duplicatesRemoved,\r\n    selectedYear,\r\n    showMore,\r\n    handleInputChange,\r\n    handleSearch,\r\n    handleYearChange,\r\n    toggleShowMore,\r\n    handleClear,\r\n  };\r\n};\r\n\r\nexport default useCodeSearch; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}